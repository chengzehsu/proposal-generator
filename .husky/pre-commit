#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ” Running pre-commit checks..."

# Check if there are staged files
if ! git diff --cached --quiet; then
  echo "ğŸ“ Checking TypeScript..."
  npm run type-check
  
  echo "ğŸ¨ Running Prettier..."
  npx prettier --write --ignore-unknown $(git diff --cached --name-only --diff-filter=ACM)
  
  echo "âœ¨ Running ESLint..."
  npx eslint --fix $(git diff --cached --name-only --diff-filter=ACM | grep -E '\.(ts|tsx|js|jsx)$')
  
  echo "ğŸ§ª Running tests..."
  npm test -- --passWithNoTests
  
  # Add any files that were formatted
  git add $(git diff --cached --name-only --diff-filter=ACM)
  
  echo "âœ… Pre-commit checks passed!"
else
  echo "âš ï¸  No staged files found"
fi